<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Loading and preprocessing the data</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h2>Loading and preprocessing the data</h2>

<p>The data is stored in the zip file repdata-data-activity.zip. We will first, unzip this file and load the data into data frame mydt. We see that the data frame has 3 columns</p>

<ul>
<li>date</li>
<li>interval</li>
<li>steps
The date column is stored as a factor. So, we will create a new column called Date where we will convert this into POSIXct date format and get rid of the existing date column. Then we will reorder the columns. To do this, we will use the data.table, lubridate, dplyr packages</li>
</ul>

<pre><code class="r">library(dplyr)
library(data.table)
library(lubridate)
</code></pre>

<p>Now, we read and preprocess the data</p>

<pre><code class="r">unzip(&quot;./repdata-data-activity.zip&quot;)
mydt &lt;- read.csv(&quot;activity.csv&quot;)
#convert mydt to data.table
mydt &lt;- data.table(mydt)
mydt$Date &lt;- ymd(mydt$date)
mydt &lt;- mydt %&gt;% select(-date) %&gt;% setcolorder(c(3,1,2))
head(mydt)
</code></pre>

<pre><code>##          Date steps interval
## 1: 2012-10-01    NA        0
## 2: 2012-10-01    NA        5
## 3: 2012-10-01    NA       10
## 4: 2012-10-01    NA       15
## 5: 2012-10-01    NA       20
## 6: 2012-10-01    NA       25
</code></pre>

<h2>What is mean total number of steps taken per day?</h2>

<p>Now, we do a histogram of the total steps taken in a day and in this histogram we will also indicate the mean and median of the total steps taken in a day (Mean will be drawn a red dotted line and Medial will be drawn as a blue dotted line). To enable us to do this histogram, we will group_by and summarize the data to get the total steps on each day. We will use the ggplot2 to draw the histogram.</p>

<pre><code class="r">t &lt;- mydt %&gt;% group_by(Date) %&gt;% summarize(total_steps=sum(steps, na.rm=TRUE))
head(t)
</code></pre>

<pre><code>##         Date total_steps
## 1 2012-10-01           0
## 2 2012-10-02         126
## 3 2012-10-03       11352
## 4 2012-10-04       12116
## 5 2012-10-05       13294
## 6 2012-10-06       15420
</code></pre>

<p>Now that we have created the new data structure with the total_steps on each day, let us draw a histogram using ggplot. The mean value of total steps will be represented by a red line and the median value will be represented by a blue line.</p>

<pre><code class="r">library(ggplot2)
g &lt;- ggplot(t, aes(x=total_steps)) + labs(title=&quot;Histogram of Total Steps&quot;) +
    ylab(&quot;frequency&quot;) +
    geom_histogram(binwidth=5000, color=&quot;black&quot;, fill=&quot;white&quot;) +
    geom_vline(aes(xintercept=mean(total_steps, na.rm=TRUE)), 
               color=&quot;red&quot;, linetype=&quot;dashed&quot;, size=1) +
    geom_vline(aes(xintercept=median(total_steps, na.rm=TRUE)), 
               color=&quot;blue&quot;, linetype=&quot;dashed&quot;, size=1)
g
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAtFBMVEUAAAAAADoAAGYAAP8AOmYAOpAAZrY6AAA6ADo6AGY6OpA6kNtmAABmADpmAGZmOgBmZjpmZmZmtv9/f39/f5V/f6t/lcF/q9aQOgCQOjqQkDqQkGaQtpCQ2/+Vweurf6ur1v+2ZgC2/7a2/9u2///BlX/BlavBwdbB6//Wq3/W///bkDrb29vb/7bb///l5eXrwZXr///y8vL/AAD/tmb/1qv/25D//7b//9b//9v//+v///9vFQpQAAAACXBIWXMAAAsSAAALEgHS3X78AAAPHUlEQVR4nO3dDVsbxxWG4TXUOCnYbVFik6YQSHESoHVtI6PA/v//1ZmdXSRW0u7smZn9Os97uVhIGp2zc2s/NAE3y4nKZEM3QIYJ8EoDvNIArzTAKw3wSgO80gCvNMArDfBKA7zSAK80wCsN8EoDvNIArzTAK8384P/T5wtGL9ZbJg2/entuvj58f+1u2DyeHctea5llduRd5nJa3b/5gs9lrswzjgKKjSDzgF/fJba4OqpuPXx3vnH/LvirAv0I+KHyYo83++qr88czuyvar68/mcdPslc/H1w//vSzeejhTbEjP3z3s3nKsthjbcrnmn34oHz/lPDuAfeC5dgS3v21PPj3ZrHV23+9KV6i6GOI2eiW2cAvzaSb/9md0O6M+dXrT6uTY0Nm77MwJ+bofXVw/fDmyBzWj9a87rlbe3z1gH3BamwJXzzkbhy7vf7OFjMN3B1cl330PxkdM234k+J8fFDB586iOPYbrKXd6+/cm8FlaeFPC8gCM39+7hZ89cDz4OUzfFHXvrZ9rKj7eHZavJ4tOgF0m2nDb+zx9oh7WlqUKHfWsjgKFMaWy8AbVjuuhK+euwVfPeDg3dj1NaS9w53jy6vB4+Kx4vkbV4Yjzmzgc3utbU/ye+CNVLF7SuCrsRvwxdMKePu8qhf3Lrmawkl+TvCV0/ah/rSE3Ib3OtRXY8sy7mhePVYe2qtDfdlHvxMhyGzgLUC5E768Lqvg7eNvzMX9S3ivi7tq7PP7a+PiofhmaR6zF3fm+WUfw0xIh8wGvlhUObWfpmof56ydNbYf2H49Oa3BPz9363N89YB9wXLsiwWc6jH7vFf29f5RvlA2iZP8pOF9sizPwalTvZGmkjnDmwNwf6db4EcU+1Grr8usOcP/b0e+7rrTKztfzivUlNQEXmlN4JXWBF5pTeCV1gReaU3gldYEXmlNlfD39+uah4f91KwCvEdzfgFeUhN44IFPWbMK8B7N+QV4SU3ggQc+Zc0qwHs05xfgJTVVwlMTeLU1gVdaE3ilNVXDZ/KIawLv0ZxfAuA7bG1tnsQ1gfdozi/AS2oCD7we+GoBx27t4SHwwAMPPPDAAw888MALA7xHc34BXlITeOD1wFdhAQd44IEHHnjggQceeOBTN+cX4CU1gQdeDzwLOMADDzzwwAMPPPDAAw888Emb8wvwkpoq4auwgAM88MADDzzwwAMPPPCpm/ML8JKawAOvB54FHOCBBx544IEHHnjggXf5GjWRX64x9/fu7wB4ce0+t7OpZgB8+nelX9jjJTVVwldhAQd44IEHHnjggQceeOBTN+cX4CU1gQdeDzwLOMADDzzwwAMPPPDAAw888Emb8wvwkpoq4auwgAM88MADDzzwwAMPPPCpm/ML8JKawAOvB54FHOCBBx544IEHHnjggQce+KTN+QV4SU2V8FVYwAEeeOCBBx544IEHHvjUzfkFeElN4IHXA88CDvDAAw888MADDzzwwAMPfNLm/AK8pKZK+Cos4AAPPPDAAw888MADD3zq5vwCvKQm8MDrgWcBB3jggQceeOCBBx544IEHPmlzfgFeUlMlfBUWcIAHfk+ePi4W77/kN4sf/gBeE/y3D3l+c/nt/RfzB3hF8DafLz9f5H/+cmtuLkzEszaaBMBH7GIUadogs9N/vsyffrstv0//rvQLe7ykpj/8jTnYP+/xwEszNfinj5fmK+d4dfA39qx+MZOrehZwlH6OBx544IEHHnjggQceeOCBBz5pc35hAUdSE3jggQceeOCBBx544IGXBniP5vwCvKSmSngWcIAHHnjggQceeOCBBx544JM25xfgJTVVwldhAQd44IEHHnjggQceeOBTN+cX4CU1gQdeDzwLOMADDzzwwAMPPPDAAw888Emb8wvwkpoq4auwgAM88MADDzzwwAMPPPCpm/ML8JKawAOvB54FHOCBBx544IEHHnjg9cCvTo6A1wif58sse3UOvD54k8ezLDudF3wVFnD2wj+8sXv86t018JrgVyevP+3f+PTN+QV4Sc1G+Oakb84vwEtqNsMvzdn9bt/VXfrm/AK8pGYj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" alt="plot of chunk drawHist"/> </p>

<h2>What is the average daily activity pattern?</h2>

<p>To get the average daily patter, we will first create a data frame that has the average steps in every 5 minute interval across all days. Then we use this data frame to draw a plot. On the plot, we draw a line on the interval containing the maximum average steps.</p>

<pre><code class="r">t &lt;- mydt %&gt;% group_by(interval) %&gt;% summarize(avg_steps=mean(steps, na.rm=T))
p &lt;- ggplot(data=t, aes(x=interval, y=avg_steps)) + geom_line() +
    labs(title=&quot;Line Graph of average steps in 5 Min Intervals&quot;)
a &lt;- t[avg_steps==max(t$avg_steps), ]
p &lt;- p + geom_vline(aes(xintercept=a$interval), linetype=&quot;dashed&quot;)
p &lt;- p + scale_x_continuous(breaks= c(seq(0,2000,by=500),a$interval),
                            labels=c(seq(0,2000,by=500),a$interval))
p
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk avg_daily_pattern"/> </p>

<h2>Imputing missing values</h2>

<ol>
<li>Calculate and report the total number of missing values in the dataset (i.e. the total number of rows with NAs)</li>
</ol>

<p>We first create a new data frame where steps has NA and count the rows in that data fram</p>

<pre><code class="r">a &lt;- mydt[is.na(mydt$steps), ]
nrow(a)
</code></pre>

<pre><code>## [1] 2304
</code></pre>

<ol>
<li>Devise a strategy for filling in all of the missing values in the dataset. The strategy does not need to be sophisticated. For example, you could use the mean/median for that day, or the mean for that 5-minute interval, etc.</li>
<li>Create a new dataset that is equal to the original dataset but with the missing data filled in.</li>
</ol>

<p>(a) We will create a new data frame that has the average steps in that interval across all and then merge it with the data frame with mising values (created in previous step).</p>

<p>(b) We will create a data frame from mydt by eliminating the NAs in the steps column</p>

<p>&copy; We will rbind the data frames created in the 2 steps above. This will give us a complete data set with NAs being replaced by the interval averages</p>

<pre><code class="r">#(a) We create a data frame with just NULL
a &lt;- mydt[is.na(mydt$steps), ]
#We create a new df with interval averages
int_avg &lt;- mydt %&gt;% group_by(interval) %&gt;% 
    summarize(avg_steps=mean(steps, na.rm=T))
b &lt;- merge(int_avg, a, by=&quot;interval&quot;)
b &lt;- select(b, -steps)
setcolorder(b, c(3,2,1))
setnames(b, c(&quot;Date&quot;, &quot;steps&quot;, &quot;interval&quot;))

#(b) We will create a data frame from mydt by eliminating NAs in steps
c &lt;- mydt[!is.na(mydt$steps), ]

#(c) rowbind the 2 data frames and arrange the rows
full &lt;- rbind(c, b)
arrange(full, Date, interval)
</code></pre>

<pre><code>##              Date     steps interval
##     1: 2012-10-01 1.7169811        0
##     2: 2012-10-01 0.3396226        5
##     3: 2012-10-01 0.1320755       10
##     4: 2012-10-01 0.1509434       15
##     5: 2012-10-01 0.0754717       20
##    ---                              
## 17564: 2012-11-30 4.6981132     2335
## 17565: 2012-11-30 3.3018868     2340
## 17566: 2012-11-30 0.6415094     2345
## 17567: 2012-11-30 0.2264151     2350
## 17568: 2012-11-30 1.0754717     2355
</code></pre>

<ol>
<li>Make a histogram of the total number of steps taken each day and Calculate and report the mean and median total number of steps taken per day. Do these values differ from the estimates from the first part of the assignment? What is the impact of imputing missing data on the estimates of the total daily number of steps?</li>
</ol>

<pre><code class="r">t4 &lt;- full %&gt;% group_by(Date) %&gt;% summarize(total_steps=sum(steps, na.rm=TRUE))
g &lt;- ggplot(t4, aes(x=total_steps)) + labs(title=&quot;Histogram of Total Steps&quot;) +
    ylab(&quot;frequency&quot;) +
    geom_histogram(binwidth=5000, color=&quot;black&quot;, fill=&quot;white&quot;) +
    geom_vline(aes(xintercept=mean(total_steps, na.rm=TRUE)), 
               color=&quot;red&quot;, linetype=&quot;dashed&quot;, size=1) +
    geom_vline(aes(xintercept=median(total_steps, na.rm=TRUE)), 
               color=&quot;blue&quot;, linetype=&quot;dashed&quot;, size=1)
g
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-3"/> </p>

<p>From the above graph, we see that the histogram shape has changed and the mean and median have converged</p>

<h2>Are there differences in activity patterns between weekdays and weekends?</h2>

</body>

</html>
